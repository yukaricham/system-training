4章：PHPの基礎２
===

# 前回やったこと
- PHPの開始と終了
- 関数
- 変数

# エディタ
さて、PHPをどんどん書いていきますがメモ帳だとちょっとつらくなってきます。
ちゃんとしたプログラミング用のエディタを使ったほうがミスが減ります。

Mac/Windows両方でているのでこちらのエディタは比較的使いやすく、人気があります。

http://www.sublimetext.com/2

無料でつかうことができるのでぜひつかってみてください。

# 変数
それでは引き続き、変数についてもう少しやっていきましょう。以下のコードを実行してみてください。

```php
<?php

$val  = 'hogehoge';
$val2 = 123;

echo $val;
echo '<br>';
echo $val2;
?>
```

$valと$val2にはそれぞれ代入した値が入っています。$valには文字列、$val2には数値が入っています。プログラミングにおいて、文字列と数値の扱いはまったく異なるので注意しましょう。

# 四則演算
それでは、計算をしてみましょう。プログラミングにおける四則演算は、数学などで使われている記号と若干ことなります。以下の様になります。


|数学|PHP|
|:--|:--|
|×|*|
|+|+|
|-|-|
|÷|/|
|%|余り|

この演算子はほかの言語でもほぼ同様です。それでは実際に計算してみましょう。

```php
<?php

echo 1 + 1;
echo '<br />';

echo 5 * 5;
echo '<br />';

echo 5 / 5;
echo '<br />';

echo 5 - 5;
echo '<br />';
?>
```

このようにして計算します。ちなみに数値の計算は上記のようにできますが、文字列を結合したい場合は記述方法が異なります。

# 文字列結合

```php
<?php

echo 'hogehoge' . 'fugafuga';

?>
```

このように、文字列を結合したい場合は```.```でつなげることで文字列を結合させることができます。それでは以下の場合どうでしょうか？実行結果を想像してから実行してみましょう。

```php
<?php

$val1 = 14;
$val2 = 16;

echo $val1 + $val2;
echo '<br />';
echo $val1 . $val2;

?>
```

# 配列
さて、ここまではプログラミング感はあまりなくなんとなくイメージしやすかったと思います。次は、プログラミング感がかなり増えてくる配列をやります。

いままでは、変数に何らかの値を代入するときは１つしか入れることができませんでした。以下の様な感じですね。

```php
<?php

$val = 'hoge';

?>
```

当然ですが、上記のコードでは、```$val```という変数にはhogeという文字列が入っています。これだけだとプログラミングをするには都合が悪い時があります。例えば、複数件ありうるようなデータを扱う場合です。

- nanapiのユーザーデータ一覧を取得したい
- nanapiの記事一覧を取得したい etc...

などなど、複数になるけど何件になるかわからないようなデータを扱うことがプログラミングにおいては多々あります。そういった、複数のデータを集合体として扱うことができる仕組みがあります。

それを配列と呼びます。それでは以下のコードを書いてみましょう。


```php
<?php

$val = array(
  'foo',
  'bar',
  'buzz',
);

?>
```

このように書くことで、$valには複数の値が格納されていることになります。$valには文字列や数値という形式でデータが格納されていません。そのため、そのままechoしようとしても表示されません。複数ある値のどれを表示していいかわからないからです。配列における値のことを **要素** と呼びます。

配列における値へ直接アクセスしたい場合は以下のようにしてアクセスします。

```php
<?php

$val = array(
  'foo',
  'bar',
  'buzz',
);

echo $val[0] . '<br />';
echo $val[1] . '<br />';
echo $val[2] . '<br />';

?>
```

``` $val = array(...) ```のなかで定義されている順番どおりに変数の後ろに```[1]```みたいにして順番を指定してあげることで配列の要素へアクセスすることができます。この配列の順番は```[0]```から始まるので注意してください。

## 配列をループする
さて、さきほどは配列の要素に対して直接アクセスする方法をやりました。しかしこの方法だと、配列の個数が事前にわかってないと使えない方法です。さっきも話したように、どれだけの数がきても正しく動くプログラムを書くために配列を利用するようなケースがあります。

そういった場合は、上記のような使い方でなく **配列すべての要素にアクセスできる仕組み** を使う必要があります。それでは以下のコードを実行してみましょう。

```php
<?php

$val = array(
  'foo',
  'bar',
  'buzz',
);

foreach ($val as $v) {
  echo $v . '<br/>';
}

?>
```

foreachという関数を使うと、指定した配列のすべての要素の最後にいくまで```{}```の中に書かれたコードを複数回実行し続けます。今回は、要素の数が３つなので```{}```の中にかかれたコードが３回実行されている事になります。

また、```foreach ($val as $v) ```の意味は、$valを３回実行するときに、それぞれの要素を$vに自動的に代入してやるよ、という意味です。このようにして、配列のすべての要素に対してアクセスすることができます。

# 連想配列
次は連想配列です。プログラミングにおいて、連想配列はものすごく重要で絶対に避けては通ることはできません。
しかし、連想配列を正しく理解しうまく使うことができるようになればいっきにできることが増えますのでしっかりと理解してください。

使い方は先ほどの配列に似ていますが、データの定義の方法が異なってきます。以下のようにして記述します。

```php
<?php

$val = array(
 'key1' => 'hoge',
 'key2' => 'fuga',
 'key3' => 'piyo',
);

?>
```

また、以下のようにして記述することもできます。

```php
<?php

$val['key1'] = 'hoge';
$val['key2'] = 'fuga';
$val['key3'] = 'piyo';

?>
```

さて若干書き方が変わりました。先ほどの配列は、配列でつかう値だけを記述する方法でしたが、連想配列においては、 **キーと値** という概念が出てきます。

配列においては、定義した順番で```[0]```のようにアクセスすることができますが、連想配列は順番は関係ありません。自分でアクセスするためのキーを定義できます。そのため、以下のようにして要素へアクセスします。

```php
<?php

$val = array(
 'key1' => 'hoge',
 'key2' => 'fuga',
 'key3' => 'piyo',
);

echo $val['key1'] . '<br/>';
echo $val['key2'] . '<br/>';
echo $val['key3'] . '<br/>';

?>
```

さっきやったように、foreachをつかってアクセスすることもできます。若干記述方法が異なります。

```php
<?php

$val = array(
 'key1' => 'hoge',
 'key2' => 'fuga',
 'key3' => 'piyo',
);

foreach ($val as $k => $v) {
  echo 'key: '. $k ;
  echo 'value:' . $v;
  echo '<br/>';

}

?>
```

上記のように記述します。```{}```の中が複数回実行される点は同じですが、```foreach ($val as $k => $v){..}```の記述がことなります。

これは、ループ内において、連想配列のキーと値両方を取得することができます。このようにして、キーと値をペアで取得したりして使います。

# 実践的な使い方
ここで話した配列と連想配列を組み合わせて様々なデータ構造を定義することができます。配列と連想配列もそれぞれ組み合わせることもできます。例えば以下の様なデータ構造も可能です。

```php
<?php

$val = array(
  'foo' => array(
    'bar' => array(
      'buzz' => array(
        'hoge','fuga','piyo'
      )
    )
  )
);

?>
```

連想配列の中に連想配列があってさらにそのなかにある連想配列の中に配列がある、というような構造です。文字にするとものすごくわかりづらいですが、コードでみたほうがわかりやすいと思います。

なんでこんな複雑なことやるの？と思うでしょうが、これは多くの場合データ構造としてつかったりします。nanapiであれば、以下の様なデータ構造があったりします。

```php
<?php

$data = array(
  'User' => array(
    'id'       => 1,
    'username' => 'wadap',
    'nickname' => 'わだっぷ'
  ),
  'Title' => array(
    array(
      'title'    => 'マラソンを走る方法',
      'document' => 'ほげほげほげ....'
    ),
    array(
      'title'    => 'マラソンを走る方法',
      'document' => 'ほげほげほげ....'
    ),
    array(
      'title'    => 'マラソンを走る方法',
      'document' => 'ほげほげほげ....'
    )
  )
);

?>
```

最初のうちはすごく複雑に見えると思いますが、このデータ構造をぱっとみてわかるようになればプログラマに相当近づいた証拠です。ぜひ慣れていきましょう。
