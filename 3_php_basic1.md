3章：PHPの基礎

===

# PHPがやっていること
さて、HTMLとCSSをこれまで学んできました。そろそろプログラミングに入っていこうと思います。
以前に、ブラウザからリクエストをおくってレスポンスが返ってくるみたいな話をしたと思います。このなかでPHPがどの場所で動いてるのかを考えてみましょう。

## ステップ1
ブラウザがhttpリクエストを送ります。これは先週telnetコマンドで実施した内容と似たようなことです。

## ステップ2
httpリクエストがサーバーに到達したら、サーバーはリクエスト受け取ります。

## ステップ3
受け取ったら、サーバーはリクエストに対するhttpレスポンスを用意します。このレスポンスを用意する時点で、PHPなどのサーバサイドのプログラミング言語が動作します。
また、MySQLなどのデータベースに問い合わせるのもこの時点です。

## ステップ4
サーバーはレスポンスを、リクエストを送ってきたブラウザに対して返します。

多くの場合はhtmlを返します。

## ステップ5
ブラウザはレスポンスを解釈します。ここの解釈の仕方がブラウザによって異なります。
多くの場合はブラウザはhtmlを読み込みます。

## ステップ6
必要に応じてブラウザから再度httpリクエストを送ります。

このように、PHPはリクエストを受け取りレスポンスを生成するサーバ側でうごく言語です。そのため「サーバサイド」というような呼ばれ方をしています。
その他、PHP以外にサーバサイドで使われる言語だと、「Ruby」「Perl」「Java」「Python」などが挙げられます。

ブラウザはHTML/CSSしか解釈することができませんが、サーバサイドはサーバのOSさえサポートしていれば自由に言語を選定することができます。

# 言語によって何が違うのか
今回はPHPを学習しますが、サーバサイドでうごく技術はPHPの他にも様々な言語があります。
nanapiはPHPという言語でできていますが、その他にもPHPをつかっている会社はたくさんあります。
例えば、言語ごとに企業（サービス）をまとめると以下のようになります。

## PHP
- gree
- facebook
- yahoo
- nanapi

## perl
- mixi
- hatena
- 旧ライブドア

## ruby
- cookpad
- nanapiの次世代サービス

## java
- ameba(サイバー全体では異なる)
- 楽天
- NHN
- google

ネット上では宗教論争のように様々な言語の優劣が語られていますが、実際のところそこまで大きな違いがあるわけではありません。
最終的には好みで語られる世界ですし、いっぱしのエンジニアであれば2つ以上の言語は扱えて当然だったりします。

ただし、このなかでPHPだけはちょっと特殊です。数ある言語の中で、唯一Web開発のためにつくられた言語です。
そのためWeb開発を学ぶ上では非常にとっつきやすく、なんとなく雰囲気で書くことができます。
この点は賛否両論ですが、入門には持って来いだと思います。

# PHPを動かそう！
さて、PHPはサーバサイドで動く言語なのでPHPがうごく環境を用意してあげないといけません。
エンジニアによっては、MacやWindows内にPHP環境を作る人もいますが面倒なので今回はやりません。
サーバ側にアップロードして、動かすという手法を取ります。

## ファイルサーバにアップロード
今回用に、fs01にアップロードするとPHPが動作するような環境を構築しました。以下のパスが実行用のフォルダになります。

```
fs01.local/public/SystemTraining/2014
```

上記のフォルダの中に自分の名前のフォルダを作成してください。すでにwadapというフォルダがあります。
このフォルダができたら、以下のファイルを保存してアップロードしてください。


index.phpというファイル名で保存

```
<?php
echo 'Hello World!';
?>
```

すると、以下の様なパスに保存されてると思います。

```
fs01.local/public/SystemTraining/2014/wadap/index.php
```

このように保存した場合、以下のURLから参照できるようになっています。

http://fs01.local/SystemTraining/2014/wadap/index.php

次回からこのように、fs01へアップロードしてブラウザから確認という流れになりますのでここはしっかりと確認してください。
ちなみに、世間ではこんな仕組みはありません。一般的なレンタルサーバは、ファイルを作成したらftpクライアントでアップロードみたいなやり方です。

# はじめてのPHP
それではさっき書いたPHPをもう一度みてみましょう。

```
<?php
echo 'Hello World!';
?>
```

これが実際のPHPのコードです。一つずつ説明していきます。

## PHPの文法
プログラミング言語はどんな言語であれ、きまった文法があります。その文法にしたがって書かないとエラーがでます。
最初はエラーだらけですし、どうでもいいようなエラーと戦うことになりますが、がんばりましょう。

### PHPの開始と終了
まず重要なポイントはここです。PHPは```<?php .... ?>```でかこまれたこの部分をPHPのプログラムとして解釈します。ここでかこまれた部分をPHPが解釈できなくなるとエラーが発生します。それでは以下のコードにかきかえてみてください。

```
<?php

echo 'Hello World!';
aaaaaaaaaaaaaaaa

?>
```

実行してみるとエラーがでましたね。今回は、aaaaaaaaaaaaaaaという部分がPHPが会社できなかったのでエラーがでました。エラーメッセージをよく呼んでみましょう。文法エラーと表示されていますね。このようにエラーを正しく読めば何のせいで動いていないのかを理解することができます。

しつこいようですが、エラーメッセージはちゃんと読みましょう！簡単な英語ですし、難しくありません。

### 上記以外の場所にかくとどうなる？
それでは以下のコードを実行してみてください。

```
<p>
<?php
echo 'Hello World!';
?>

</p>
```

表示されたら、ブラウザの右クリックから「ページのソースを表示」からHTMLソースをみてみましょう。```<p>...</p>```の部分がちゃんとタグとして表示されていますね。
このように、```<?php....?>```以外の場所にかくとHTMLとして認識させることができます。

# 関数と変数

## 関数
プログラミング言語には、関数というものが用意されていて様々な命令を送ることができます。さきほどのサンプルにもあった```echo```というのも関数の一つです。

それでは感覚を使うためにも以下のコードをかいてみてください。

```
<?php

echo "Hello World 1";
echo "Hello World 2";
echo "Hello World 3";

?>
```

このように、echoを3回したい場合は3行にわたって記述することができます。なお、行の最後には```;```（セミコロン）を入れる必要があります。


## 変数

それでは、次は以下のコードを実行してみましょう。

```
<?php

$val = 'hogehoge';
echo $val;

?>
```
